{"ast":null,"code":"import React,{useState,useEffect}from'react';import'./WeatherWidget.css';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";function WeatherWidget(){const[weather,setWeather]=useState(null);const[loading,setLoading]=useState(true);const API_KEY='4cc9911b0a2723050929b73c2a59e727';useEffect(()=>{if(!navigator.geolocation){alert('Геолокация недоступна в этом браузере');setLoading(false);return;}navigator.geolocation.getCurrentPosition(position=>{const{latitude,longitude}=position.coords;fetchWeatherByCoords(latitude,longitude);},error=>{alert('Не удалось получить координаты: '+error.message);setLoading(false);});},[]);const fetchWeatherByCoords=async(lat,lon)=>{try{setLoading(true);const response=await fetch(\"https://api.openweathermap.org/data/2.5/weather?lat=\".concat(lat,\"&lon=\").concat(lon,\"&units=metric&lang=ru&appid=\").concat(API_KEY));if(!response.ok)throw new Error('Не удалось получить погоду');const data=await response.json();setWeather({temp:Math.round(data.main.temp),description:data.weather[0].description,name:data.name});}catch(err){alert(err.message);setWeather(null);}setLoading(false);};return/*#__PURE__*/_jsxs(\"div\",{className:\"weather-widget widget\",children:[loading&&/*#__PURE__*/_jsx(\"p\",{children:\"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0430 \\u043F\\u043E\\u0433\\u043E\\u0434\\u044B...\"}),!loading&&weather&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"weather-city\",children:weather.name}),/*#__PURE__*/_jsxs(\"div\",{className:\"weather-temp\",children:[weather.temp,\"\\xB0C\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"weather-desc\",children:weather.description})]}),!loading&&!weather&&/*#__PURE__*/_jsx(\"p\",{children:\"\\u041F\\u043E\\u0433\\u043E\\u0434\\u0430 \\u043D\\u0435\\u0434\\u043E\\u0441\\u0442\\u0443\\u043F\\u043D\\u0430\"})]});}export default WeatherWidget;","map":{"version":3,"names":["React","useState","useEffect","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","WeatherWidget","weather","setWeather","loading","setLoading","API_KEY","navigator","geolocation","alert","getCurrentPosition","position","latitude","longitude","coords","fetchWeatherByCoords","error","message","lat","lon","response","fetch","concat","ok","Error","data","json","temp","Math","round","main","description","name","err","className","children"],"sources":["C:/Users/axm/Documents/sites/Pet-projects/custom-newtab-extension/src/components/WeatherWidget.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport './WeatherWidget.css';\r\n\r\nfunction WeatherWidget() {\r\n  const [weather, setWeather] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const API_KEY = '4cc9911b0a2723050929b73c2a59e727';\r\n\r\n  useEffect(() => {\r\n    if (!navigator.geolocation) {\r\n      alert('Геолокация недоступна в этом браузере');\r\n      setLoading(false);\r\n      return;\r\n    }\r\n\r\n    navigator.geolocation.getCurrentPosition(\r\n      (position) => {\r\n        const { latitude, longitude } = position.coords;\r\n        fetchWeatherByCoords(latitude, longitude);\r\n      },\r\n      (error) => {\r\n        alert('Не удалось получить координаты: ' + error.message);\r\n        setLoading(false);\r\n      }\r\n    );\r\n  }, []);\r\n\r\n  const fetchWeatherByCoords = async (lat, lon) => {\r\n    try {\r\n      setLoading(true);\r\n      const response = await fetch(\r\n        `https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&units=metric&lang=ru&appid=${API_KEY}`\r\n      );\r\n      if (!response.ok) throw new Error('Не удалось получить погоду');\r\n      const data = await response.json();\r\n      setWeather({\r\n        temp: Math.round(data.main.temp),\r\n        description: data.weather[0].description,\r\n        name: data.name\r\n      });\r\n    } catch (err) {\r\n      alert(err.message);\r\n      setWeather(null);\r\n    }\r\n    setLoading(false);\r\n  };\r\n\r\n  return (\r\n    <div className=\"weather-widget widget\">\r\n      {loading && <p>Загрузка погоды...</p>}\r\n\r\n      {!loading && weather && (\r\n        <>\r\n          <div className=\"weather-city\">{weather.name}</div>\r\n          <div className=\"weather-temp\">{weather.temp}°C</div>\r\n          <div className=\"weather-desc\">{weather.description}</div>\r\n        </>\r\n      )}\r\n\r\n      {!loading && !weather && (\r\n        <p>Погода недоступна</p>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default WeatherWidget;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}